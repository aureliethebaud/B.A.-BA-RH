@model IEnumerable<BabaRh.Web.Models.ViewModel.QuestionVM>


@Html.Partial( "~/Views/Shared/_LayoutQuestionsManager.cshtml")

@{
    ViewBag.Title = "Index";
}

<div class="marginAfterLeftNavBar">

    <h2>Liste des questions</h2>

    <p>
        @Html.ActionLink("Create New", "Create")
    </p>



    @{
        List<int> modules = new List<int>();
        List<(int, List<int>)> modulesQuestions = new List<(int, List<int>)>();

        foreach (var question in Model)
        {
            if (!modules.Contains(question.Module.ModuleId))
            {
                modules.Add(question.Module.ModuleId);
            }
        }

        foreach (var module in modules)
        {
            List<int> questions = new List<int>();
            foreach (var question in Model)
            {
                if (module == question.Module.ModuleId)
                {
                    questions.Add(question.QuestionId);
                }
            }
            modulesQuestions.Add((module, questions));
        }
    }

    @foreach (var module in modules)
    {
        <dl>
            <dt>@Html.DisplayNameFor(model => model.Module)</dt>
            <dd>@Model.FirstOrDefault(q => q.Module.ModuleId == module).Module.ModuleLib</dd>

            <dd>                               
                <table>
                    <tr>
                        <th>Niveau</th>
                        <th>Question ouverte ?</th>
                        <th>Intitulé de la question</th>
                        <th>Action</th>
                    </tr>
                    @foreach (var question in Model.Where(q => q.Module.ModuleId == module).OrderBy(q => q.Niveau.NiveauId))
                    {
                        <tr>

                            <td>@question.Niveau.NiveauLib</td>
                            <td>@question.QuestionOuverte</td>
                            <td>@question.QuestionLib</td>
                            <td>
                                @Html.ActionLink("Edit", "Edit", new { id = question.QuestionId }) |
                                @Html.ActionLink("Details", "Details", new { id = question.QuestionId })  |                                
                                @Html.ActionLink("Delete", "Delete", new { id = question.QuestionId })
                            </td>
                          
                        </tr>
                    }

                    </table>                 

            </dd>
        </dl>
    }

</div>

<style>
    .marginAfterLeftNavBar
    {
        margin-left: 180px;
    }    
</style>



